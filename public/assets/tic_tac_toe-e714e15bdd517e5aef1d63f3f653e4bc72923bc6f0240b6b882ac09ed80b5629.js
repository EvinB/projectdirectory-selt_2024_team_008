let eventListenersAttached=!1;document.addEventListener("turbolinks:load",()=>{if(eventListenersAttached)return;const e=document.querySelector(".board");let t="X",r=Array(9).fill("");const n=document.querySelector(".game-message"),o=document.querySelector(".shard-balance-display p");e.addEventListener("click",a=>{const c=a.target;if(!c.classList.contains("cell")||c.textContent)return;const s=parseInt(c.dataset.index,10);console.log(`User clicked cellIndex=${s}, board before move:`,r),fetch(`/games/${gameId}/tic_tac_toe/play`,{method:"POST",headers:{"Content-Type":"application/json","X-CSRF-Token":document.querySelector('meta[name="csrf-token"]').getAttribute("content")},body:JSON.stringify({move:s,"board[]":r,current_turn:t})}).then(e=>e.json()).then(t=>{if(console.log("Server response:",t),t.error)return console.error("Server error:",t.error),void(n.textContent="A server error occurred. Please try again.");t.board.forEach((e,t)=>{const n=document.querySelector(`.cell[data-index="${t}"]`);e?(n.textContent=e,n.className="cell "+e.toLowerCase()):(n.textContent="",n.className="cell"),r[t]=e||""}),"continue"!==t.status&&(n.textContent=t.message,o.textContent=`Shard Balance: ${t.new_shard_balance} Shards`,e.classList.add("disabled"))})["catch"](e=>{console.error("Error:",e),n.textContent="An error occurred. Please try again."})}),eventListenersAttached=!0});